---
description: Runtime expectations, environment setup, and version numbering standards
globs: **/*
alwaysApply: true
version: 1.3.0
lastUpdated: 04-12-2025 13:17:07 EST
type: Environment/Configuration Rule - Defines runtime expectations and setup
relatedCommands: [create-start-scripts.md]
relatedRules: [auto-heal.mdc, task-workflow.mdc, date-time.mdc]
relatedStandards: [architecture/supabase-local-setup.md, deployment/application-launch.md]
---

# Environment & Runtime Standards

## Metadata
- **Created:** 2025-11-17
- **Last Updated:** 04-12-2025 13:17:07 EST
- **Version:** 1.3
- **Description:** Runtime expectations, environment setup, and version numbering standards

## Version Numbering Rules

### Rule Files (`.cursor/rules/*.mdc`)
- **Format:** Semantic versioning (X.Y.Z)
- **Major (X):** Breaking changes or major architectural changes
- **Minor (Y):** New features or significant additions
- **Patch (Z):** Bug fixes, clarifications, or minor updates
- **Update Required:** Version must be incremented whenever the file content changes
- **Metadata:** Include version in frontmatter: `version: X.Y.Z`
- **Example:** If adding a new section → increment minor version (1.0.0 → 1.1.0)

### Command Files (`.cursor/commands/*.md`)
- **Format:** Semantic versioning (X.Y.Z)
- **Update Required:** Version must be incremented when:
  - Command behavior changes
  - New parameters or options are added
  - Output format changes
  - Dependencies or prerequisites change
- **Metadata:** Include version in frontmatter or header comment
- **Example:** `# Command: command-name v2.0.0`

### Standards Files (`standards/**/*.md`)
- **Format:** Semantic versioning (X.Y)
- **Major (X):** Breaking changes or major standard revisions
- **Minor (Y):** New guidelines, clarifications, or additions
- **Update Required:** Version must be incremented when:
  - New requirements are added
  - Existing requirements are modified
  - Examples or patterns are significantly updated
- **Metadata:** Include in document header: `Version: X.Y`
- **Example:** `# Standard_Name_v1.2`

### Checklist Files (`docs/process/checklists/*.md`)
- **Format:** Semantic versioning (X.Y)
- **Update Required:** Version must be incremented when:
  - New checklist items are added
  - Existing items are modified or removed
  - Validation criteria change
- **Naming:** Include version in filename: `checklist_name_v1_0.md`
- **Metadata:** Include in document header: `Version: X.Y`

### General Guidelines
- **Always increment version** when making changes (no exceptions)
- **Update "Last Updated" date** in metadata when version changes
- **Document version changes** in CHANGELOG.md for significant updates
- **Consistent format:** Use semantic versioning across all file types
- **Version in filename:** For checklists, include version in filename (e.g., `_v1_0.md`)
- **Version in metadata:** For rules, commands, and standards, include in frontmatter or header

## 1. Runtime Expectations

This project operates in a "Container-Like" local environment.
- **Strict Isolation:** Dependencies must be local (`node_modules`, `.venv`). Do not rely on global system packages.
- **Configuration:** All config comes from `.env` or the database. Hardcoded ports/URLs are forbidden.
- **Launch:** Always use `./start_app.sh` to start the app. If `start_app.sh` doesn't exist, run the `create-start-scripts` command (`.cursor/commands/create-start-scripts.md`) to generate it.

## 2. Local Docker Dev Environment

### 2.1 Docker Compose Projects

If `docker-compose.yml` is present:
1.  **Prefer Docker:** Use Docker for databases (Postgres, Redis) and infrastructure.
2.  **Hybrid App:** Run the *application code* locally (Node/Python) for faster HMR, but connect to *Dockerized services*.
3.  **Logs:** View container logs via Docker Desktop or `docker logs`.

### 2.2 Supabase Local Development

If `supabase/` directory is present:
1.  **Use Supabase CLI:** Always use `supabase start/stop/status` commands for container management.
2.  **Container Isolation (CRITICAL):** Only affect containers belonging to the current project.
   - ✅ Use `supabase start` - Starts only current project's containers
   - ✅ Use `supabase stop` - Stops only current project's containers
   - ❌ Never use `docker stop $(docker ps -q)` - This affects ALL containers across all projects
3.  **Setup:** See `standards/architecture/supabase-local-setup.md` for complete installation and configuration guide.
4.  **Environment Variables:** Retrieve local credentials with `supabase status` and configure in `.env.local`.

## 3. MCP Loadout Instructions

Ensure the following MCP servers are active if relevant:
- **Supabase:** For database inspection and edge function management.
- **Postgres:** For direct SQL execution if Supabase MCP is unavailable.
- **Notion:** For project and task management integration (required if Notion Project Binding rule exists).
- **Filesystem:** For reading/writing local files (standard).

## 4. Dependency Management

- **Node:** Use `npm` (default), `yarn`, or `pnpm` based on lockfile presence.
- **Python:** Always use a virtual environment.
- **Lockfiles:** Never delete lockfiles to "fix" errors. Fix the dependency conflict instead.

## 5. Container Management Rules (CRITICAL)

**Note:** For date and time awareness requirements, see `.cursor/rules/date-time.mdc`.

When working with Docker or Supabase containers in multi-project environments:

1.  **Project-Specific Commands:**
   - Always use project-specific commands (`supabase start/stop` for Supabase, filtered Docker commands for other services).
   - Never use broad commands that affect all containers.

2.  **Container Identification:**
   - For Supabase: Use `supabase status` to identify current project's containers.
   - For Docker Compose: Filter by project name or use project-specific compose files.

3.  **Port Conflicts:**
   - Identify which project owns the conflicting container before stopping.
   - Only stop containers belonging to the current project.
   - If unsure, ask the user which project should use the port.

4.  **Error Recovery:**
   - See `.cursor/rules/auto-heal.mdc` Section 6 for detailed container management error recovery.
   - See `standards/architecture/supabase-local-setup.md` Section 10 for Supabase-specific container isolation guidelines.

---

## Related Files

- **Commands:**
  - [create-start-scripts.md](../commands/create-start-scripts.md) - Generates application launch scripts
- **Rules:**
  - [auto-heal.mdc](./auto-heal.mdc) - Error recovery strategies including container management
  - [task-workflow.mdc](./task-workflow.mdc) - Development workflow that uses these environment standards
  - [date-time.mdc](./date-time.mdc) - Date and time awareness for AI agents
- **Standards:**
  - [supabase-local-setup.md](../../standards/architecture/supabase-local-setup.md) - Supabase local setup guide
  - [application-launch.md](../../standards/deployment/application-launch.md) - Application launch standards

---

## How to Use This Rule

**This rule applies automatically to all files in the repository.**

**Agents should:**
- Follow version numbering rules when updating any documentation (rules, commands, standards, checklists)
- Always increment version numbers when making changes
- Use `./start_app.sh` to launch applications (or run `create-start-scripts` if missing)
- Use project-specific commands for Docker/Supabase containers (never affect all containers)
- Ensure strict dependency isolation (use local `node_modules`, `.venv`, etc.)
- For date/time operations, see `.cursor/rules/date-time.mdc`
